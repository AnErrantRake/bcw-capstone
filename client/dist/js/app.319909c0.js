(function(t){function e(e){for(var n,r,i=e[0],l=e[1],c=e[2],u=0,d=[];u<i.length;u++)r=i[u],a[r]&&d.push(a[r][0]),a[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);p&&p(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,r=1;r<o.length;r++){var l=o[r];0!==a[l]&&(n=!1)}n&&(s.splice(e--,1),t=i(i.s=o[0]))}return t}var n={},a={app:0},s=[];function r(t){return i.p+"js/"+({ballot:"ballot",ballotCreation:"ballotCreation",election:"election",electionStatus:"electionStatus"}[t]||t)+"."+{ballot:"3f3d6e39",ballotCreation:"1ee332e1",election:"c25c1bef",electionStatus:"d332a61c"}[t]+".js"}function i(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(t){var e=[],o=a[t];if(0!==o)if(o)e.push(o[2]);else{var n=new Promise(function(e,n){o=a[t]=[e,n]});e.push(o[2]=n);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=r(t),s=function(e){l.onerror=l.onload=null,clearTimeout(c);var o=a[t];if(0!==o){if(o){var n=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+n+": "+s+")");r.type=n,r.request=s,o[1](r)}a[t]=void 0}};var c=setTimeout(function(){s({type:"timeout",target:l})},12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(e)},i.m=t,i.c=n,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var p=c;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},1857:function(t,e,o){"use strict";var n=o("6bc4"),a=o.n(n);a.a},"56d7":function(t,e,o){"use strict";o.r(e);var n=o("2b0e"),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},s=[],r={name:"App"},i=r,l=o("2877"),c=Object(l["a"])(i,a,s,!1,null,null,null),u=c.exports,p=o("8c4f"),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"login"},[t.loginForm?o("form",{on:{submit:function(e){return e.preventDefault(),t.loginUser(e)}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.creds.username,expression:"creds.username"}],attrs:{type:"text",placeholder:"Enter your name"},domProps:{value:t.creds.username},on:{input:function(e){e.target.composing||t.$set(t.creds,"username",e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.creds.password,expression:"creds.password"}],attrs:{type:"password",placeholder:"password"},domProps:{value:t.creds.password},on:{input:function(e){e.target.composing||t.$set(t.creds,"password",e.target.value)}}}),o("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[t._v("Login")])]):o("form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newUser.username,expression:"newUser.username"}],attrs:{type:"text",placeholder:"name"},domProps:{value:t.newUser.username},on:{input:function(e){e.target.composing||t.$set(t.newUser,"username",e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.newUser.password,expression:"newUser.password"}],attrs:{type:"password",placeholder:"password"},domProps:{value:t.newUser.password},on:{input:function(e){e.target.composing||t.$set(t.newUser,"password",e.target.value)}}}),o("button",{staticClass:"btn btn-warning",attrs:{type:"submit"}},[t._v("Create Account")])]),o("div",{staticClass:"action",on:{click:function(e){t.loginForm=!t.loginForm}}},[t.loginForm?o("p",[t._v("No account? Click here to Register")]):o("p",[t._v("Already have an account? Click here to Login")])]),o("form",{on:{submit:function(e){return e.preventDefault(),t.getElection(e)}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.pin,expression:"pin"}],attrs:{type:"text",placeholder:"pin"},domProps:{value:t.pin},on:{input:function(e){e.target.composing||(t.pin=e.target.value)}}}),o("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[t._v("What's for Lunch?")])])])},m=[],h={name:"login",data(){return{loginForm:!0,creds:{username:"",password:""},newUser:{username:"",password:""},pin:""}},beforeCreate(){this.$store.state.user._id&&this.$router.push({name:"home"})},methods:{register(){this.$store.dispatch("register",this.newUser)},loginUser(){this.$store.dispatch("login",this.creds)},getElection(){this.$store.dispatch("getElectionByPin",this.pin)}}},g=h,b=(o("1857"),Object(l["a"])(g,d,m,!1,null,"037bd2c5",null)),f=b.exports,v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"home"},[o("h1",[t._v("Logged in!")]),o("button",{staticClass:"btn btn-warning",attrs:{type:"submit"},on:{click:t.logout}},[t._v("Logout")]),o("h1",[t._v("Ballots!")]),o("router-link",{staticClass:"btn btn-success",attrs:{to:{name:"ballotCreation"}}},[t._v("Create New Ballot")]),o("ul",t._l(t.ballots,function(e){return o("li",[o("router-link",{attrs:{to:{name:"ballot",params:{ballotID:e._id}}}},[t._v(t._s(e.name))]),o("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(o){return t.startElection(e._id)}}},[t._v("Start")]),o("button",{staticClass:"btn btn-danger",attrs:{type:"submit"},on:{click:function(o){return t.deleteBallot(e._id)}}},[t._v("Delete")])],1)}),0),o("h1",[t._v("Elections")]),o("ul",t._l(t.elections,function(e){return o("li",[o("router-link",{attrs:{to:{name:"electionStatus",params:{electionID:e._id}}}},[t._v(t._s(e.pin))]),o("button",{staticClass:"btn btn-danger",attrs:{type:"submit"},on:{click:function(o){return t.deleteElection(e._id)}}},[t._v("Delete")])],1)}),0)],1)},w=[],y={name:"home",mounted(){this.$store.dispatch("getBallots"),this.$store.dispatch("getElections")},data(){return{}},computed:{ballots(){return this.$store.state.ballots},elections(){return this.$store.state.elections}},methods:{deleteBallot(t){this.$store.dispatch("deleteBallot",t)},deleteElection(t){this.$store.dispatch("deleteElection",t)},startElection(t){this.$store.dispatch("startElection",t)},logout(){this.$store.dispatch("logout")}},components:{}},E=y,_=Object(l["a"])(E,v,w,!1,null,"818f5aba",null),B=_.exports;n["a"].use(p["a"]);var C=new p["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:B},{path:"/election/:electionPin",name:"election",props:!0,component:function(){return o.e("election").then(o.bind(null,"5ad3"))}},{path:"/login",name:"login",component:f},{path:"/ballot/new",name:"ballotCreation",component:function(){return o.e("ballotCreation").then(o.bind(null,"a2db"))}},{path:"/ballot/:ballotID",name:"ballot",props:!0,component:function(){return o.e("ballot").then(o.bind(null,"4c09"))}},{path:"/election/status/:electionID",name:"electionStatus",props:!0,component:function(){return o.e("electionStatus").then(o.bind(null,"4492"))}},{path:"*",redirect:"/"}]}),$=o("2f62"),k=o("bc3a"),A=o.n(k);let x=location.host.includes("localhost")?"//localhost:3000/":"https://bcw-capstone-wafl.herokuapp.com/",U=A.a.create({baseURL:x+"account/",timeout:3e3,withCredentials:!0});class P{static async Login(t){try{let o=await U.post("login",t);return o.data}catch(e){throw new Error(`[login failed] : ${e.response?e.response.data.error:"No response from server"}`)}}static async Register(t){try{let o=await U.post("register",t);return o.data}catch(e){throw new Error(`[registration failed] : ${e.response?e.response.data.error:"No response from server"}`)}}static async Logout(){try{await U.delete("logout");return!0}catch(t){throw new Error(`[logout failed] : ${t.response?t.response.data.error:"No response from server"}`)}}static async Authenticate(){try{let e=await U.get("authenticate");return e.data}catch(t){console.warn(`[Authentication failed] : ${t.response?t.response.data.error:"No response from server"}`)}}}n["a"].use($["a"]);let S=window.location.host.includes("localhost:8080")?"//localhost:3000/":"https://bcw-capstone-wafl.herokuapp.com/",j=A.a.create({baseURL:S+"api/",timeout:3e3,withCredentials:!0});var N=new $["a"].Store({state:{user:{},ballots:[],elections:[],activeBallot:{},activeElection:{}},mutations:{setUser(t,e){t.user=e},resetState(t){t.user={},t.ballots=[],t.elections=[],t.activeBallot={},t.activeElection={}},setBallots(t,e){t.ballots=e},addBallot(t,e){t.ballots.push(e)},deleteBallot(t,e){let o=t.ballots.findIndex(t=>t._id===e);o>=0&&t.ballots.splice(o,1)},setActiveBallot(t,e){t.activeBallot=e},setElections(t,e){t.elections=e},startElection(t,e){t.elections.push(e)},deleteElections(t,e){let o=t.elections.findIndex(t=>t._id===e);o>=0&&t.elections.splice(o,1)},setActiveElection(t,e){t.activeElection=e},setActiveBallot(t,e){t.activeBallot=e}},actions:{async register({commit:t,dispatch:e},o){try{let e=await P.Register(o);t("setUser",e),C.push({name:"home"})}catch(n){console.warn(n.message)}},async login({commit:t,dispatch:e},o){try{let e=await P.Login(o);t("setUser",e),C.push({name:"home"})}catch(n){console.warn(n.message)}},async logout({commit:t,dispatch:e}){try{await P.Logout();t("resetState"),C.push({name:"login"})}catch(o){console.warn(o.message)}},async getBallots({commit:t,dispatch:e}){await j.get("ballots").then(e=>t("setBallots",e.data)).catch(t=>console.error(t))},async getBallotByID({commit:t,dispatch:e},o){await j.get("ballots/"+o).then(e=>{t("setActiveBallot",e.data),C.push({name:"ballot",params:{ballotID:e.data._id}})}).catch(t=>console.error(t))},async addBallot({commit:t,dispatch:e},o){await j.post("ballots",o).then(e=>t("addBallot",e.data)).catch(t=>console.error(t))},async deleteBallot({commit:t,dispatch:e},o){await j.delete("ballots/"+o).then(e=>t("deleteBallot",o)).catch(t=>console.error(t))},async getElections({commit:t,dispatch:e}){await j.get("elections").then(e=>t("setElections",e.data)).catch(t=>console.error(t))},async getElectionByID({commit:t,dispatch:e},o){await j.get("elections/"+o).then(e=>{t("setActiveElection",e.data)}).catch(t=>console.error(t))},async getElectionByPin({commit:t,dispatch:e},o){await j.get("elections/vote/"+o).then(e=>{t("setActiveElection",e.data),C.push({name:"election",params:{electionPin:o}})}).catch(t=>console.error(t))},async startElection({commit:t,dispatch:e},o){let n={timeoutEpoch:0,votes:[],ballotID:o};await j.post("elections",n).then(e=>t("startElection",e.data)).catch(t=>console.error(t))},async deleteElection({commit:t,dispatch:e},o){await j.delete("elections/"+o).then(e=>t("deleteElections",o)).catch(t=>console.error(t))},async getActiveElection({commit:t,dispatch:e},o){await j.get("elections/"+o).then(e=>t("setActiveElection",e.data)).catch(t=>console.error(t))},async getActiveBallot({commit:t,dispatch:e},o){await j.get("ballots/"+o).then(e=>t("setActiveBallot",e.data)).catch(t=>console.error(t))},async submitVotes({commit:t,dispatch:e},o){await j.put("elections/vote/"+this.state.activeElection.pin,o).then(()=>C.push({name:"login"})).catch(t=>console.error(t))}}}),D=o("9483");async function O(){let t=await P.Authenticate();t?N.commit("setUser",t):C.push({name:"login"}),new n["a"]({router:C,store:N,render:function(t){return t(u)}}).$mount("#app")}Object(D["a"])("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),n["a"].config.productionTip=!1,O()},"6bc4":function(t,e,o){}});
//# sourceMappingURL=app.319909c0.js.map